/*
  Messages as a separate scene
*/

export default class messageBox extends Phaser.Scene {
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
  constructor () {
    super('message');
  }
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
  init (data) {
    this.textArray = data.textArray;
    this.returningScene = data.returning;
  }
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
  preload() {

  }
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
  create() {
    this.X = this.input.keyboard.addKey("X");

    this.count = 0;

    //Creating text
    this.createContainer();
  }
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
  update() {
    var isDown = this.input.keyboard.checkDown(this.X, 250);
    if (isDown) {
      this.count++;
      this.updateInteraction();
    }
  }

  updateInteraction() {
    if (this.count == this.textArray.length) {
      this.msgBox.destroy();
      this.scene.resume(this.returningScene);
      this.scene.stop();
    } else {
      this.message.setText(this.textArray[this.count]);
    }
  }
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
  createContainer() {
    const w = 1280 * 0.9;
    const h = 720;

    //Container for the creation of the box and the text
    var msgBox = this.add.container(0, h * 0.875);

    //Creating the box for the textbox
    var boxBack = this.add.image(1280 * 0.5, h * .1, "caveTestRock");
    boxBack.setDisplaySize(1280, h*0.2);
    boxBack.alpha = (1);
    //var boxFrame = this.scene.add.sprite(0, 0, "boxFrame");

    this.message = this.add.text(0, 0, this.textArray[this.count], {
      font: "18px monospace",
      fill: "#fff",
      wordWrap: { width: w, useAdvancedWrap: true },
      padding: { x: 20, y: 20 }
    });

    msgBox.add(boxBack);
    msgBox.add(this.message);

    this.msgBox = msgBox;
  }
/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
}
